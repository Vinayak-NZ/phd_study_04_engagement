)
bf_act <- bf(
action_plan ~ co_creation_method + hapa1_t1 + hapa2_t1 + hapa3_t1 + hapa4_t1 + hapa5_t1,
family = bernoulli(link = "logit")
)
bf_time_spent <- bf(
average_time_spent_scaled ~ co_creation_method + hapa1_t1 + hapa2_t1 + hapa3_t1 + hapa4_t1 + hapa5_t1,
family = student()
)
bf_days_between <- bf(
days_between ~ co_creation_method + hapa1_t1 + hapa2_t1 + hapa3_t1 + hapa4_t1 + hapa5_t1,
family = negbinomial()
)
bf_comm <- bf(
comm_mean_scaled ~ co_creation_method * time + hapa1_t1 + hapa2_t1 + hapa3_t1 + hapa4_t1 + hapa5_t1 + (1 | id),
family = gaussian()
)
bf_safe <- bf(
safe_mean_scaled ~ co_creation_method * time + hapa1_t1 + hapa2_t1 + hapa3_t1 + hapa4_t1 + hapa5_t1 + (1 | id),
family = gaussian()
)
summary(data_imputed_long$age)
summary(data_imputed_output[[1]]$age)
nrow(data_imputed_output[[1]]$age)
nrows(data_imputed_output[[1]]$age)
nrow(data_imputed_output[[1]])
summary(data_imputed_output[[1]]$in_app_age_grp)
table(data_imputed_output[[1]]$in_app_age_grp)
source("R/05_post_impute_edits.R")
source("R/04_process_sentiment_data.R")
## ---- analyse-data-bayesian
source("R/06_set_priors_sentiment_analysis.R")
data_imputed_long <- do.call(rbind, data_imputed_output)
priors_progress <-
set_prior(sprintf("normal(%f, %f)", prior_progress_pe, prior_progress_sd),
class = "b", coef = "co_creation_method1")
priors_action_plan <-
set_prior(sprintf("normal(%f, %f)", prior_action_plan_pe, prior_action_plan_sd),
class = "b", coef = "co_creation_method1")
priors_time_spent <-
set_prior(sprintf("normal(%f, %f)", prior_time_spent_pe, prior_time_spent_sd),
class = "b", coef = "co_creation_method1")
priors_comms <-
set_prior(sprintf("normal(%f, %f)", prior_comms_pe, prior_comms_sd),
class = "b", coef = "co_creation_method1:time2")
priors_safe <-
set_prior(sprintf("normal(%f, %f)", prior_safety_pe, prior_safety_sd),
class = "b", coef = "co_creation_method1:time2")
bf_freq <- bf(
total_log_in ~ co_creation_method + in_app_age_grp + hapa1_t1 + hapa2_t1,
family = negbinomial()
)
bf_prog <- bf(
progress_score_scaled ~ co_creation_method + in_app_age_grp + hapa1_t1 + hapa2_t1,
family = student()
)
bf_act <- bf(
action_plan ~ co_creation_method + in_app_age_grp + hapa1_t1 + hapa2_t1,
family = bernoulli(link = "logit")
)
bf_time_spent <- bf(
average_time_spent_scaled ~ co_creation_method + in_app_age_grp + hapa1_t1 + hapa2_t1,
family = student()
)
bf_days_between <- bf(
days_between ~ co_creation_method + in_app_age_grp + hapa1_t1 + hapa2_t1,
family = negbinomial()
)
bf_comm <- bf(
comm_mean_scaled ~ co_creation_method * time + in_app_age_grp + hapa3_t1 + (1 | id),
family = gaussian()
)
bf_safe <- bf(
safe_mean_scaled ~ co_creation_method * time + in_app_age_grp + hapa3_t1 + (1 | id),
family = gaussian()
)
model_freq <- brm(
bf_freq,
data = data_imputed_long,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
summary(data_imputed_long$hapa1_t1)
summary(data_imputed_long$in_app_age_grp)
summary(model_freq)
model_progress <- brm(
bf_prog,
data = data_imputed_long,
prior = priors_progress,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_progress_summary <- summary(model_progress)
model_progress_summary
model_act_plan <- brm(
bf_act,
data = data_imputed_long,
prior = priors_action_plan,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_act_plan_summary <- summary(model_act_plan)
model_act_plan_summary
model_time_spent <- brm(
bf_time_spent,
data = data_imputed_long,
prior = priors_time_spent,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_time_spent_summary <- summary(model_time_spent)
model_time_spent_summary
model_days_between <- brm(
bf_days_between,
data = data_imputed_long,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_days_between_summary <- summary(model_days_between)
model_days_between_summary
model_comm <- brm(
bf_comm,
data = data_imputed_long,
prior = priors_comms,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_comm_summary <- summary(model_comm)
model_comm_summary
model_safe <- brm(
bf_safe,
data = data_imputed_long,
prior = priors_safe,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_safe_summary <- summary(model_safe)
model_safe_summary
install.packages("miceadds")
library(miceadds)
imp2 <-
miceadds::datalist2mids(data_imputed_output)
fit_lmer <- with(
imp2,
lm(progress_score_scaled ~ co_creation_method + in_app_age_grp)
)
pooled <- pool(fit_lmer)
summ   <- summary(pooled)
summ$fmi
how_many_imputations(fit_lmer)
install.packages("how_many_imputations")
install.packages("howManyImputations")
library(howManyImputations)
how_many_imputations(fit_lmer)
how_many_imputations(fit_lmer, cv = .01)
imp2 <-
miceadds::datalist2mids(data_imputed_output)
fit_lmer <- with(
imp2,
lm(comm_mean_scaled ~ co_creation_method * time + (1 | id))
)
fit_lmer <- with(
imp2,
lm(comm_mean_scaled ~ co_creation_method * time)
)
pooled <- pool(fit_lmer)
summ   <- summary(pooled)
summ$fmi
how_many_imputations(fit_lmer)
how_many_imputations(fit_lmer, cv = .01)
?how_many_imputations
how_many_imputations(fit_lmer, cv = .10)
## ---- prep-data
source("R/00_load_data.R")
source("R/00_load_functions.R")
source("R/00_load_package.R")
source("R/01_format_active_data.R")
source("R/01_format_passive_data.R")
source("R/02_format_active_data_feedback.R")
source("R/02_format_active_data_hapa.R")
source("R/02_format_active_data_outcomes.R")
source("R/02_format_app_v2_baseline.R")
source("R/02_format_baseline_all.R")
source("R/02_format_demographics_in_app.R")
source("R/02_join_data.R")
source("R/03_prepare_data.R")
source("R/04_derive_variables.R")
source("R/04_process_app_use_data.R")
saveRDS(data_imputed, file = "output/imputed_data_2025_11_14.rds")
source("R/05_post_impute_edits.R")
source("R/04_process_sentiment_data.R")
## ---- analyse-data-bayesian
source("R/06_set_priors_sentiment_analysis.R")
data_imputed_long <- do.call(rbind, data_imputed_output)
priors_progress <-
set_prior(sprintf("normal(%f, %f)", prior_progress_pe, prior_progress_sd),
class = "b", coef = "co_creation_method1")
priors_action_plan <-
set_prior(sprintf("normal(%f, %f)", prior_action_plan_pe, prior_action_plan_sd),
class = "b", coef = "co_creation_method1")
priors_time_spent <-
set_prior(sprintf("normal(%f, %f)", prior_time_spent_pe, prior_time_spent_sd),
class = "b", coef = "co_creation_method1")
priors_comms <-
set_prior(sprintf("normal(%f, %f)", prior_comms_pe, prior_comms_sd),
class = "b", coef = "co_creation_method1:time2")
priors_safe <-
set_prior(sprintf("normal(%f, %f)", prior_safety_pe, prior_safety_sd),
class = "b", coef = "co_creation_method1:time2")
bf_freq <- bf(
total_log_in ~ co_creation_method + in_app_age_grp,
family = negbinomial()
)
bf_prog <- bf(
progress_score_scaled ~ co_creation_method + in_app_age_grp,
family = student()
)
bf_act <- bf(
action_plan ~ co_creation_method + in_app_age_grp,
family = bernoulli(link = "logit")
)
bf_time_spent <- bf(
average_time_spent_scaled ~ co_creation_method + in_app_age_grp,
family = student()
)
bf_days_between <- bf(
days_between ~ co_creation_method + in_app_age_grp,
family = negbinomial()
)
bf_comm <- bf(
comm_mean_scaled ~ co_creation_method * time + (1 | id),
family = gaussian()
)
bf_safe <- bf(
safe_mean_scaled ~ co_creation_method * time + (1 | id),
family = gaussian()
)
model_freq <- brm(
bf_freq,
data = data_imputed_long,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_freq_summary <- summary(model_freq)
model_freq_summary
imp2 <-
miceadds::datalist2mids(data_imputed_output)
fit_lmer <- with(
imp2,
lm(comm_mean_scaled ~ co_creation_method * time)
)
pooled <- pool(fit_lmer)
summ   <- summary(pooled)
summ$fmi
how_many_imputations(fit_lmer)
how_many_imputations(fit_lmer, cv = .01)
how_many_imputations(fit_lmer, cv = .05)
imp2 <-
miceadds::datalist2mids(data_imputed_output)
fit_lmer <- with(
imp2,
lm(safe_mean_scaled ~ co_creation_method * time)
)
pooled <- pool(fit_lmer)
summ   <- summary(pooled)
summ$fmi
how_many_imputations(fit_lmer)
how_many_imputations(fit_lmer, cv = .05)
## ---- prep-data
source("R/00_load_data.R")
source("R/00_load_functions.R")
source("R/00_load_package.R")
source("R/01_format_active_data.R")
source("R/01_format_passive_data.R")
source("R/02_format_active_data_feedback.R")
source("R/02_format_active_data_hapa.R")
source("R/02_format_active_data_outcomes.R")
source("R/02_format_app_v2_baseline.R")
source("R/02_format_baseline_all.R")
source("R/02_format_demographics_in_app.R")
source("R/02_join_data.R")
source("R/03_prepare_data.R")
source("R/04_derive_variables.R")
source("R/04_process_app_use_data.R")
data_imputed$loggedEvents
source("R/05_post_impute_edits.R")
source("R/04_process_sentiment_data.R")
summary(data_imputed_output[[1]]$hapa1_t1)
summary(data_imputed_output[[1]]$hapa1_t4)
summary(data_imputed_output[[1]]$hapa4_t1)
## ---- analyse-data-bayesian
source("R/06_set_priors_sentiment_analysis.R")
data_imputed_long <- do.call(rbind, data_imputed_output)
any(data_imputed_long < 0, na.rm = TRUE)
cols_with_negatives <- sapply(data_imputed_long, function(x) any(x < 0, na.rm = TRUE))
cols_with_negatives
data_imputed_output <- list()
for (i in 1:data_imputed$m){
data_imputed_output[[i]] <- complete(data_imputed, i)
}
data_imputed_long <- do.call(rbind, data_imputed_output)
any(data_imputed_long < 0, na.rm = TRUE)
cols_with_negatives <- sapply(data_imputed_long, function(x) any(x < 0, na.rm = TRUE))
cols_with_negatives
source("R/05_post_impute_edits.R")
source("R/04_process_sentiment_data.R")
## ---- analyse-data-bayesian
source("R/06_set_priors_sentiment_analysis.R")
data_imputed_long <- do.call(rbind, data_imputed_output)
priors_progress <-
set_prior(sprintf("normal(%f, %f)", prior_progress_pe, prior_progress_sd),
class = "b", coef = "co_creation_method1")
priors_action_plan <-
set_prior(sprintf("normal(%f, %f)", prior_action_plan_pe, prior_action_plan_sd),
class = "b", coef = "co_creation_method1")
priors_time_spent <-
set_prior(sprintf("normal(%f, %f)", prior_time_spent_pe, prior_time_spent_sd),
class = "b", coef = "co_creation_method1")
priors_comms <-
set_prior(sprintf("normal(%f, %f)", prior_comms_pe, prior_comms_sd),
class = "b", coef = "co_creation_method1:time2")
priors_safe <-
set_prior(sprintf("normal(%f, %f)", prior_safety_pe, prior_safety_sd),
class = "b", coef = "co_creation_method1:time2")
bf_freq <- bf(
total_log_in ~ co_creation_method + in_app_age_grp,
family = negbinomial()
)
bf_prog <- bf(
progress_score_scaled ~ co_creation_method + in_app_age_grp,
family = student()
)
bf_act <- bf(
action_plan ~ co_creation_method + in_app_age_grp,
family = bernoulli(link = "logit")
)
bf_time_spent <- bf(
average_time_spent_scaled ~ co_creation_method + in_app_age_grp,
family = student()
)
bf_days_between <- bf(
days_between ~ co_creation_method + in_app_age_grp,
family = negbinomial()
)
bf_comm <- bf(
comm_mean_scaled ~ co_creation_method * time + (1 | id),
family = gaussian()
)
bf_safe <- bf(
safe_mean_scaled ~ co_creation_method * time + (1 | id),
family = gaussian()
)
model_comm <- brm(
bf_comm,
data = data_imputed_long,
prior = priors_comms,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_freq <- brm(
bf_freq,
data = data_imputed_long,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_freq_summary <- summary(model_freq)
saveRDS(model_freq, file = paste0("output/model_freq_", Sys.Date(), ".rds"))
sink(paste0("output/model_freq_", Sys.Date(), ".txt"))
print(summary(model_freq))
sink()
model_freq_summary
model_progress <- brm(
bf_prog,
data = data_imputed_long,
prior = priors_progress,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_progress_summary <- summary(model_progress)
saveRDS(model_progress, file = paste0("output/model_progress_", Sys.Date(), ".rds"))
sink(paste0("output/model_progress_", Sys.Date(), ".txt"))
print(summary(model_progress))
sink()
model_progress_summary
model_act_plan <- brm(
bf_act,
data = data_imputed_long,
prior = priors_action_plan,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_act_plan_summary <- summary(model_act_plan)
saveRDS(model_act_plan, file = paste0("output/model_act_plan_", Sys.Date(), ".rds"))
sink(paste0("output/model_act_plan_", Sys.Date(), ".txt"))
print(summary(model_act_plan))
sink()
model_act_plan_summary
model_time_spent <- brm(
bf_time_spent,
data = data_imputed_long,
prior = priors_time_spent,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_time_spent_summary <- summary(model_time_spent)
saveRDS(model_time_spent, file = paste0("output/model_time_spent_", Sys.Date(), ".rds"))
sink(paste0("output/model_time_spent_", Sys.Date(), ".txt"))
print(summary(model_time_spent))
sink()
model_time_spent_summary
model_days_between <- brm(
bf_days_between,
data = data_imputed_long,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_days_between_summary <- summary(model_days_between)
saveRDS(model_days_between, file = paste0("output/model_days_between_", Sys.Date(), ".rds"))
sink(paste0("output/model_days_between_", Sys.Date(), ".txt"))
print(summary(model_days_between))
sink()
model_days_between_summary
model_comm <- brm(
bf_comm,
data = data_imputed_long,
prior = priors_comms,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_comm_summary <- summary(model_comm)
saveRDS(model_comm, file = paste0("output/model_comm_", Sys.Date(), ".rds"))
sink(paste0("output/model_comm_", Sys.Date(), ".txt"))
print(summary(model_comm))
sink()
model_comm_summary
model_safe <- brm(
bf_safe,
data = data_imputed_long,
prior = priors_safe,
seed = 555,
chains = 4,
cores = 4,
iter = 4000,
warmup = 500,
backend = "cmdstanr",
control = list(adapt_delta = 0.95, max_treedepth = 15))
model_safe_summary <- summary(model_safe)
saveRDS(model_safe, file = paste0("output/model_safe_", Sys.Date(), ".rds"))
sink(paste0("output/model_safe_", Sys.Date(), ".txt"))
print(summary(model_safe))
sink()
model_safe_summary
