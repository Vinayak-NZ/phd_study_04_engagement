scale_fill_manual(values = c("#46e7fd",
"#4739a2",
"#e18b22")) +
scale_y_discrete(labels = c("1" = "Version 1",
"2" = "Version 2")) +
labs(title = "B. Age Distribution of V1 and V2 Users (in proportions)",
y = NULL,
x = "",
fill = "Age") +
xlab("Version") +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold")
)
plot_age
plot_age <-
ggplot(table_in_app_age,
aes(fill = age,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#46e7fd",
"#4739a2",
"#e18b22")) +
scale_y_discrete(labels = c("1" = "Version 1",
"2" = "Version 2")) +
labs(title = "B. Age Distribution of V1 and V2 Users (in proportions)",
y = NULL,
x = "",
fill = "Age") +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold")
)
plot_age
plot_age <-
ggplot(table_in_app_age,
aes(fill = age,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#46e7fd",
"#4739a2",
"#e18b22")) +
labs(title = "B. Age Distribution of V1 and V2 Users (in proportions)",
y = NULL,
x = "",
fill = "Age") +
xlab("Version") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"))
plot_age
plot_age <-
ggplot(table_in_app_age,
aes(fill = age,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#46e7fd",
"#4739a2",
"#e18b22")) +
labs(title = "B. Age Distribution of V1 and V2 Users (in proportions)",
y = NULL,
x = "",
fill = "Age") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic")) +
coord_flip()
plot_age
plot_age <-
ggplot(table_in_app_age,
aes(fill = age,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#46e7fd",
"#4739a2",
"#e18b22")) +
scale_y_discrete(labels = c("1" = "Version 1",
"2" = "Version 2")) +
labs(title = "B. Age Distribution of V1 and V2 Users (in proportions)",
y = "Proportion",
x = "",
fill = "Age") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic")) +
coord_flip()
plot_age
plot_age <-
ggplot(table_in_app_age,
aes(fill = age,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#46e7fd",
"#4739a2",
"#e18b22")) +
scale_x_discrete(labels = c("1" = "Version 1",
"2" = "Version 2")) +
labs(title = "B. Age Distribution of V1 and V2 Users (in proportions)",
y = "Proportion",
x = "",
fill = "Age") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic")) +
coord_flip()
plot_age
combined_plot <- plot_hapa / plot_age +
plot_annotation(
title = "End User Profile for V1 and V2",
subtitle = "Baseline motivational profiles (HAPA) and age distribution at sign-in",
theme = theme(
plot.title = element_text(size = 18, face = "bold"),
plot.subtitle = element_text(size = 14)
)
)
ggsave("output/combined_plot.png",
plot = combined_plot,
device = 'tiff',
width = 12, height = 6)
combined_plot
table(data_no_impute$in_app_age_grp)
summary(data_no_impute$in_app_age_grp)
summary(data_no_impute$in_app_age_grp)[3]
sum(summary(data_no_impute$in_app_age_grp)[1:3])
(summary(data_no_impute$in_app_age_grp)[4]/
sum(summary(data_no_impute$in_app_age_grp)[1:3]))*100
41/888
4/888
4/888*100
prop.table(data_no_impute$in_app_age_grp)
prop.table(table(data_no_impute$in_app_age_grp))
prop.table(table(data_no_impute$in_app_age_grp))*100
(summary(data_no_impute[data_no_impute$co_creation_method == 0, ]$in_app_age_grp)[4]/
sum(summary(data_no_impute[data_no_impute$co_creation_method == 0, ]$in_app_age_grp)[1:3]))*100
prop.table(table(data_no_impute[data_no_impute$co_creation_method == 0, ]$in_app_age_grp))*100
(summary(data_no_impute[data_no_impute$co_creation_method == 1, ]$in_app_age_grp)[4]/
sum(summary(data_no_impute[data_no_impute$co_creation_method == 1, ]$in_app_age_grp)[1:3]))*100
prop.table(table(data_no_impute[data_no_impute$co_creation_method == 1, ]$in_app_age_grp))*100
(summary(data_no_impute[data_no_impute$co_creation_method == 0, ]$in_app_age_grp)[4]/
nrow(data_no_impute[data_no_impute$co_creation_method == 0, ]))*100
(summary(data_no_impute[data_no_impute$co_creation_method == 0, ]$in_app_age_grp)/
nrow(data_no_impute[data_no_impute$co_creation_method == 0, ]))*100
(summary(data_no_impute[data_no_impute$co_creation_method == 1, ]$in_app_age_grp)/
nrow(data_no_impute[data_no_impute$co_creation_method == 1, ]))*100
table(data_no_impute$co_creation_method)
mean(data_no_impute[data_no_impute$co_creation_method == 0]$hapa1_t1, na.rm = TRUE)
mean(data_no_impute[data_no_impute$co_creation_method == 0]$hapa1_t1, na.rm = TRUE)
mean(data_no_impute[data_no_impute$co_creation_method == 0]$hapa2_t1, na.rm = TRUE)
mean(data_no_impute[data_no_impute$co_creation_method == 0]$hapa3_t1, na.rm = TRUE)
mean(data_no_impute[data_no_impute$co_creation_method == 0]$hapa4_t1, na.rm = TRUE)
mean(data_no_impute[data_no_impute$co_creation_method == 0]$hapa5_t1, na.rm = TRUE)
sd(data_no_impute[data_no_impute$co_creation_method == 0]$hapa1_t1, na.rm = TRUE)
sd(data_no_impute[data_no_impute$co_creation_method == 0]$hapa2_t1, na.rm = TRUE)
sd(data_no_impute[data_no_impute$co_creation_method == 0]$hapa3_t1, na.rm = TRUE)
sd(data_no_impute[data_no_impute$co_creation_method == 0]$hapa4_t1, na.rm = TRUE)
sd(data_no_impute[data_no_impute$co_creation_method == 0]$hapa5_t1, na.rm = TRUE)
mean(data_no_impute[data_no_impute$co_creation_method == 1]$hapa1_t1, na.rm = TRUE)
mean(data_no_impute[data_no_impute$co_creation_method == 1]$hapa2_t1, na.rm = TRUE)
mean(data_no_impute[data_no_impute$co_creation_method == 1]$hapa3_t1, na.rm = TRUE)
mean(data_no_impute[data_no_impute$co_creation_method == 1]$hapa4_t1, na.rm = TRUE)
mean(data_no_impute[data_no_impute$co_creation_method == 1]$hapa5_t1, na.rm = TRUE)
sd(data_no_impute[data_no_impute$co_creation_method == 1]$hapa1_t1, na.rm = TRUE)
sd(data_no_impute[data_no_impute$co_creation_method == 1]$hapa2_t1, na.rm = TRUE)
sd(data_no_impute[data_no_impute$co_creation_method == 1]$hapa3_t1, na.rm = TRUE)
sd(data_no_impute[data_no_impute$co_creation_method == 1]$hapa4_t1, na.rm = TRUE)
sd(data_no_impute[data_no_impute$co_creation_method == 1]$hapa5_t1, na.rm = TRUE)
mean_output <- list()
for (i in 0:1){
for (j in 1:5){
mean_output[i][j] <-
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("hapa", j, "_t1")]],
na.rm = TRUE)
}
}
mean_output
mean_output_v1 <- list()
sd_output_v1 <- list()
for (i in 1:5){
mean_output_v1[[i]] <-
mean(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", j, "_t1")]],
na.rm = TRUE)
sd_output_v1[[i]] <-
sd(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", j, "_t1")]],
na.rm = TRUE)
}
mean_output_v1
mean_output_v1 <- list()
for (i in 1:5){
mean_output_v1[[i]][1] <-
mean(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", j, "_t1")]],
na.rm = TRUE)
mean_output_v1[[i]][2] <-
sd(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", j, "_t1")]],
na.rm = TRUE)
}
for (i in 1:5){
mean_output_v1[[i]][1] <-
mean(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE)
mean_output_v1[[i]][2] <-
sd(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE)
}
mean_output_v1 <- list()
for (i in 1:5){
mean_output_v1[[i]] <-
c(mean(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE))
}
mean_output_v1
desc_output_v1 <- list()
desc_output_v2 <- list()
for (i in 1:5){
desc_output_v1[[i]] <-
c(paste0("HAPA", " ", i),
mean(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE))
desc_output_v2[[i]] <-
c(paste0("HAPA", " ", i),
mean(data_no_impute[
data_no_impute$co_creation_method == 1][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == 1][[paste0("hapa", i, "_t1")]],
na.rm = TRUE))
}
desc_output_v1
sum(is.na(data_no_impute$hapa1_t1))
desc_output_v1 <- list()
desc_output_v2 <- list()
for (i in 1:5){
desc_output_v1[[i]] <-
c(paste0("HAPA", " ", i),
mean(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sum(is.na(data_no_impute[[paste0("hapa", i, "_t1")]]))/
nrow(data_no_impute))
desc_output_v2[[i]] <-
c(paste0("HAPA", " ", i),
mean(data_no_impute[
data_no_impute$co_creation_method == 1][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == 1][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sum(is.na(data_no_impute[[paste0("hapa", i, "_t1")]]))/
nrow(data_no_impute))
}
desc_output_v1
desc_output_v1 <- list()
desc_output_v2 <- list()
for (i in 1:5){
desc_output_v1[[i]] <-
c(paste0("HAPA", " ", i),
mean(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == 0]))*100)
desc_output_v2[[i]] <-
c(paste0("HAPA", " ", i),
mean(data_no_impute[
data_no_impute$co_creation_method == 1][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == 1][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == 1][[paste0("hapa", i, "_t1")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == 1])))
}
desc_output_v1
desc_output_v2
desc_output_v1 <- list()
desc_output_v2 <- list()
desc_output_v2
desc_output_v1 <- list()
desc_output_v2 <- list()
for (i in 1:5){
desc_output_v1[[i]] <-
c(paste0("HAPA", " ", i),
mean(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == 0][[paste0("hapa", i, "_t1")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == 0]))*100)
desc_output_v2[[i]] <-
c(paste0("HAPA", " ", i),
mean(data_no_impute[
data_no_impute$co_creation_method == 1][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == 1][[paste0("hapa", i, "_t1")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == 1][[paste0("hapa", i, "_t1")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == 1]))*100)
}
desc_output_v2
data_no_impute$safe_mean_pre
comm_output <- list()
safety_output <- list()
for (i in 0:1){
comm_output[[i+1]] <-
c(paste0("Version", " ", i+1, " ","comm_pre"),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_pre")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_pre")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_pre")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100,
paste0("Version", " ", "comm_post", " ", i+1),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100)
safety_output[[i+1]] <-
c(paste0("Version", " ", i+1, " ", "safe_pre"),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("safe_mean_pre")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("safe_mean_pre")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("safe_mean_pre")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100,
paste0("Version", " ", "comm_post", " ", i+1),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100)
}
comm_output
comm_output <- list()
safety_output <- list()
for (i in 0:1){
comm_output[[i+1]] <-
c(paste0("Version", " ", i+1, " ","comm_pre"),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_pre")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_pre")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_pre")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100,
paste0("Version", " ", i+1, "comm_post"),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100)
safety_output[[i+1]] <-
c(paste0("Version", " ", i+1, " ", "safe_pre"),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("safe_mean_pre")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("safe_mean_pre")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("safe_mean_pre")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100,
paste0("Version", " ", i+1, " ", "comm_post"),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100)
}
comm_output
comm_output <- list()
safety_output <- list()
for (i in 0:1){
comm_output[[i+1]] <-
c(paste0("Version", " ", i+1, " ","comm_pre"),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_pre")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_pre")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_pre")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100,
paste0("Version", " ", i+1, " ", "comm_post"),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100)
safety_output[[i+1]] <-
c(paste0("Version", " ", i+1, " ", "safe_pre"),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("safe_mean_pre")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("safe_mean_pre")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("safe_mean_pre")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100,
paste0("Version", " ", i+1, " ", "safe_post"),
mean(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
sd(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]],
na.rm = TRUE),
(sum(is.na(data_no_impute[
data_no_impute$co_creation_method == i][[paste0("comm_mean_post")]]))/
nrow(data_no_impute[
data_no_impute$co_creation_method == i]))*100)
}
comm_output
safety_output
