xlab("Education") +
ylab("Count") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"),
legend.key.width = unit(0, "pt"),
legend.spacing.x = unit(0, "pt"))
ggplot(table_education,
aes(fill = ausbildung,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#FFFFFF",
"#46e7fd",
"#4739a2",
"#fefe62",
"#d35fb7",
"#e18b22",
"#4739a2")) +
labs(title = paste0("Education level"),
subtitle = "Bar chart of highest qualification obtained",
caption = "Data source: TeamBaby",
fill = "Education") +
xlab("Education") +
ylab("Count") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"))
ggplot(table_education,
aes(fill = ausbildung,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#FFFFFF",
"#46e7fd",
"#4739a2",
"#fefe62",
"#d35fb7",
"#e18b22",
"#4739a2"),
labels = labels) +
labs(title = paste0("Education level"),
subtitle = "Bar chart of highest qualification obtained",
caption = "Data source: TeamBaby",
fill = "Education") +
xlab("Education") +
ylab("Count") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"))
ggplot(table_education,
aes(fill = ausbildung,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#000",
"#46e7fd",
"#4739a2",
"#fefe62",
"#d35fb7",
"#e18b22",
"#4739a2"),
labels = labels) +
labs(title = paste0("Education level"),
subtitle = "Bar chart of highest qualification obtained",
caption = "Data source: TeamBaby",
fill = "Education") +
xlab("Education") +
ylab("Proportion") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"))
ggplot(table_education,
aes(fill = ausbildung,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#000",
"#46e7fd",
"#ffffff",
"#fefe62",
"#d35fb7",
"#e18b22",
"#4739a2"),
labels = labels.ed) +
labs(title = paste0("Education level"),
subtitle = "Bar chart of highest qualification obtained",
caption = "Data source: TeamBaby",
fill = "Education") +
xlab("Education") +
ylab("Proportion") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"))
labels.ed <- c(L1 = 'L1 = No school-leaving qualification',
L2 = 'L2 = Secondary/ elementary school',
L3 = 'L3 = Secondary school diploma',
L4 = 'L4 = A-levels',
L5 = 'L5 = Completed vocational training',
L6 = 'L6 = University degree - Hochschule',
L7 = 'L7 = University degree')
ggplot(table_education,
aes(fill = ausbildung,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#000",
"#46e7fd",
"#ffffff",
"#fefe62",
"#d35fb7",
"#e18b22",
"#4739a2"),
labels = labels.ed) +
labs(title = paste0("Education level"),
subtitle = "Bar chart of highest qualification obtained",
caption = "Data source: TeamBaby",
fill = "Education") +
xlab("Education") +
ylab("Proportion") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"))
ggplot(table_education,
aes(fill = ausbildung,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#000",
"#46e7fd",
"#808080",
"#fefe62",
"#d35fb7",
"#e18b22",
"#4739a2"),
labels = labels.ed) +
labs(title = paste0("Education level"),
subtitle = "Bar chart of highest qualification obtained",
caption = "Data source: TeamBaby",
fill = "Education") +
xlab("Education") +
ylab("Proportion") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"))
ggplot(table_education,
aes(fill = ausbildung,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#000",
"#46e7fd",
"#e66100",
"#fefe62",
"#d35fb7",
"#e18b22",
"#4739a2"),
labels = labels.ed) +
labs(title = paste0("Education level"),
subtitle = "Bar chart of highest qualification obtained",
caption = "Data source: TeamBaby",
fill = "Education") +
xlab("Education") +
ylab("Proportion") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"))
app_baseline_valid_family <-
app_baseline[app_baseline$familie %in%
c(0, 1, 2, 3, 4, 5), ]
app_baseline_valid_family$familie <-
ifelse(app_baseline_valid_family$familie %in% c(0,1),
"RS1",
ifelse(app_baseline_valid_family$familie == 2,
"RS2",
ifelse(app_baseline_valid_family$familie == 3,
"RS3", "RS4")))
level_order <- c("RS1",
"RS2",
"RS3",
"RS4")
labels.fm <- c(RS1 = 'RS1 = Single',
RS2 = 'RS2 = Committed relationship and not registered',
RS3 = 'RS3 = Married/ Registered',
RS4 = 'RS4 = Divorced')
table_family <- as.data.frame(
table(app_baseline_valid_family$version,
app_baseline_valid_family$familie))
names(table_family)[names(table_family) == "Var1"] <-
"version"
names(table_family)[names(table_family) == "Var2"] <-
"familie"
names(table_family)[names(table_family) == "Freq"] <-
"frequency"
ggplot(table_family,
aes(fill = familie,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#000",
"#46e7fd",
"#4739a2",
"#e18b22"),
labels = labels.fm) +
labs(title = paste0("Relationship status"),
subtitle = "Bar chart of participant relationship status",
caption = "Data source: TeamBaby",
fill = "Relationship status") +
xlab("Relatonship status") +
ylab("Count") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"),
legend.key = element_rect(fill = NA),
legend.key.width = unit(0, "pt"),
legend.spacing.x = unit(0, "pt")
)
ggplot(table_family,
aes(fill = familie,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#000",
"#46e7fd",
"#4739a2",
"#e18b22"),
labels = labels.fm) +
labs(title = paste0("Relationship status"),
subtitle = "Bar chart of participant relationship status",
caption = "Data source: TeamBaby",
fill = "Relationship status") +
xlab("Relatonship status") +
ylab("Count") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic")
)
ggplot(table_education,
aes(fill = ausbildung,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#000",
"#46e7fd",
"#4739a2",
"#e18b22",
"#fefe62",
"#d35fb7",
"#009e73"),
labels = labels.ed) +
labs(title = paste0("Education level"),
subtitle = "Bar chart of highest qualification obtained",
caption = "Data source: TeamBaby",
fill = "Education") +
xlab("Education") +
ylab("Proportion") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"))
app_baseline_demo <- rbind(app_v1_baseline_demo,
app_v2_baseline_demo)
# age
t_test_age <- t.test(alter ~ version,
app_baseline_valid_age,
var.equal=TRUE)
t_test_age
# education level
chi_square_education <- chisq.test(
table(app_baseline_valid_education$version,
app_baseline_valid_education$ausbildung))
chi_square_education
# relationship status
chi_square_fam <- chisq.test(
table(app_baseline_valid_family$version,
app_baseline_valid_family$familie))
chi_square_fam
# partial-eta-squared
eta_squared <- function(model) {
SSeffect <- summary(aov(model))[[1]]["Sum Sq"]
SSerror <- sum(SSeffect) - SSeffect
eta_sq <- SSeffect / sum(SSeffect, SSerror)
return(eta_sq)
}
## ---- prep-data
source("R/00_load_data.R")
source("R/00_load_functions.R")
source("R/00_load_package.R")
source("R/01_format_active_data.R")
source("R/01_format_passive_data.R")
source("R/02_format_active_data_feedback.R")
source("R/02_format_active_data_hapa.R")
source("R/02_format_active_data_safety.R")
source("R/02_format_app_v2_baseline.R")
source("R/02_format_baseline_all.R")
source("R/02_join_data.R")
source("R/03_prepare_data.R")
source("R/04_derive_variables.R")
source("R/04_process_app_use_data.R")
source("R/04_process_sentiment_data.R")
source("R/06_model_engagement.R")
eta_squared(model_4)
model_4
install.packages("heplots")
library(heplots)
manova_model <- Anova(model_4, type = "III")
eta_squared(manova_model)
model_4
model_4[[1]]
model_4[[2]]
eta_squared(lm_total_log_in)
eta_total_log_in <- eta_squared(lm_total_log_in)
eta_progress_score <- eta_squared(lm_progress_score)
eta_action_plan <- eta_squared(lm_action_plan)
eta_average_time_spent <- eta_squared(lm_average_time_spent)
eta_days_between <- eta_squared(lm_days_between)
eta_progress_score
eta_action_plan
eta_average_time_spent
eta_days_between
renv::snapshot()
## ---- prep-data
source("R/00_load_data.R")
source("R/00_load_functions.R")
source("R/00_load_package.R")
source("R/01_format_active_data.R")
source("R/01_format_passive_data.R")
source("R/02_format_active_data_feedback.R")
source("R/02_format_active_data_hapa.R")
source("R/02_format_active_data_safety.R")
source("R/02_format_app_v2_baseline.R")
source("R/02_format_baseline_all.R")
source("R/02_join_data.R")
source("R/03_prepare_data.R")
source("R/04_derive_variables.R")
source("R/04_process_app_use_data.R")
source("R/04_process_sentiment_data.R")
app_baseline_valid <- app_baseline_demo[app_baseline_demo$alter > 18, ]
app_baseline_valid_age <-
app_baseline_valid[!is.na(app_baseline_valid$alter), ]
ggplot(app_baseline_valid_age, aes(x = alter, fill = version)) +
geom_density(alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#46e7fd", "#e18b22")) +
labs(title = paste0("Distribution of age"),
subtitle = "Histogram of age of participants in study",
caption = "Data source: TeamBaby",
fill = "Web-app version") +
xlab("Age") +
ylab("Count") +
xlim(0, 60) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic")
)
app_baseline_valid_education <-
app_baseline_demo[app_baseline_demo$ausbildung %in%
c(0, 1, 2, 3, 4, 5, 6, 7), ]
app_baseline_valid_education$ausbildung <-
ifelse(app_baseline_valid_education$ausbildung %in% c(0,1),
1,
app_baseline_valid_education$ausbildung)
app_baseline_valid_education$ausbildung <-
ifelse(app_baseline_valid_education$ausbildung == 1,
"L1",
ifelse(app_baseline_valid_education$ausbildung == 2,
"L2",
ifelse(app_baseline_valid_education$ausbildung == 3,
"L3",
ifelse(app_baseline_valid_education$ausbildung == 4,
"L4",
ifelse(app_baseline_valid_education$ausbildung == 5,
"L5",
ifelse(app_baseline_valid_education$ausbildung == 6,
"L6", "L7"))))))
labels.ed <- c(L1 = 'L1 = No school-leaving qualification',
L2 = 'L2 = Secondary/ elementary school',
L3 = 'L3 = Secondary school diploma',
L4 = 'L4 = A-levels',
L5 = 'L5 = Completed vocational training',
L6 = 'L6 = University degree - Hochschule',
L7 = 'L7 = University degree')
table_education <- as.data.frame(
table(app_baseline_valid_education$version,
app_baseline_valid_education$ausbildung))
names(table_education)[names(table_education) == "Var1"] <-
"version"
names(table_education)[names(table_education) == "Var2"] <-
"ausbildung"
names(table_education)[names(table_education) == "Freq"] <-
"frequency"
ggplot(table_education,
aes(fill = ausbildung,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#000",
"#46e7fd",
"#4739a2",
"#e18b22",
"#fefe62",
"#d35fb7",
"#009e73"),
labels = labels.ed) +
labs(title = paste0("Education level"),
subtitle = "Bar chart of highest qualification obtained",
caption = "Data source: TeamBaby",
fill = "Education") +
xlab("Education") +
ylab("Proportion") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic"))
app_baseline_valid_family <-
app_baseline_demo[app_baseline_demo$familie %in%
c(0, 1, 2, 3, 4, 5), ]
app_baseline_valid_family$familie <-
ifelse(app_baseline_valid_family$familie %in% c(0,1),
"RS1",
ifelse(app_baseline_valid_family$familie == 2,
"RS2",
ifelse(app_baseline_valid_family$familie == 3,
"RS3", "RS4")))
level_order <- c("RS1",
"RS2",
"RS3",
"RS4")
labels.fm <- c(RS1 = 'RS1 = Single',
RS2 = 'RS2 = Committed relationship and not registered',
RS3 = 'RS3 = Married/ Registered',
RS4 = 'RS4 = Divorced')
table_family <- as.data.frame(
table(app_baseline_valid_family$version,
app_baseline_valid_family$familie))
names(table_family)[names(table_family) == "Var1"] <-
"version"
names(table_family)[names(table_family) == "Var2"] <-
"familie"
names(table_family)[names(table_family) == "Freq"] <-
"frequency"
ggplot(table_family,
aes(fill = familie,
y = frequency,
x = version)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = c("#000",
"#46e7fd",
"#4739a2",
"#e18b22"),
labels = labels.fm) +
labs(title = paste0("Relationship status"),
subtitle = "Bar chart of participant relationship status",
caption = "Data source: TeamBaby",
fill = "Relationship status") +
xlab("Relatonship status") +
ylab("Count") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic")
)
ggplot(app_baseline_valid_age, aes(x = alter, fill = version)) +
geom_density(alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#46e7fd", "#e18b22")) +
labs(title = paste0("Distribution of age"),
subtitle = "Histogram of age of participants in study",
caption = "Data source: TeamBaby",
fill = "Web-app version") +
xlab("Age") +
ylab("Density") +
xlim(0, 60) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(color = "#2F2E41", size = 12, face = "bold"),
plot.subtitle = element_text(color = "#454543"),
plot.caption = element_text(color = "#454543", face = "italic")
)
source("R/06_model_engagement.R")
eta_total_log_in
lm_total_log_in
model_4
model_summary
eta_total_log_in
eta_progress_score
eta_action_plan
eta_average_time_spent
eta_days_between
